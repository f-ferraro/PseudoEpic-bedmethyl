sampleID=""

#######################################################################################################################
#######################################################################################################################
##################################################### No filters ######################################################
#######################################################################################################################
#######################################################################################################################
temp = read.delim(paste0(sampleID,".pseudoepic.bed.cpgID"), header=FALSE)
 
temp$V11 = temp$V11 / 100

output = data.frame("IllmnID" = temp$V19, 
                    'Sample' = temp$V11)
 
names(output)[names(output) == "Sample"] <- sampleID

write.table(output, paste0(sampleID,"_EPIC_stranded_unfiltered.tsv"),
            quote = F, sep = "\t", row.names = F, )
 
#######################################################################################################################
#######################################################################################################################
##################################################### With filters ####################################################
#######################################################################################################################
#######################################################################################################################
temp$TotalDepth = rowSums(temp[, colnames(temp) %in% paste0("V", seq(12,18,1))])
temp$UsableFraction = temp$V5 / temp$TotalDepth
 
temp = temp[temp$UsableFraction > 0.5,]
temp = temp[(temp$V5 > 8 & temp$V5 < 50),]

output = data.frame("IllmnID" = temp$V19, 
                    'Sample' = temp$V11)
 
names(output)[names(output) == "Sample"] <- sampleID

write.table(output, paste0(sampleID,"_EPIC_stranded_filtered.tsv"),
            quote = F, sep = "\t", row.names = F, )
 